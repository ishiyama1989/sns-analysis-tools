<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= isEdit ? 'クライアント編集' : 'クライアント登録' %> - SNS運用代行管理システム</title>
  <link rel="stylesheet" href="/style.css">
  <style>
    .form-container {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      color: #374151;
    }
    
    .form-group input,
    .form-group select {
      width: 100%;
      padding: 12px;
      border: 2px solid #e5e7eb;
      border-radius: 6px;
      font-size: 14px;
      transition: border-color 0.2s;
    }
    
    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    
    .form-group small {
      display: block;
      margin-top: 5px;
      color: #6b7280;
      font-size: 12px;
    }
    
    .form-actions {
      display: flex;
      gap: 15px;
      justify-content: flex-end;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid #e5e7eb;
    }
    
    .industry-options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }
    
    .industry-tag {
      padding: 5px 10px;
      background: #f3f4f6;
      border-radius: 20px;
      font-size: 12px;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    .industry-tag:hover {
      background: #e5e7eb;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1><%= isEdit ? 'クライアント情報編集' : '新規クライアント登録' %></h1>
      <nav>
        <a href="/companies" class="btn btn-link">← クライアント一覧に戻る</a>
        <a href="/" class="btn btn-link">ホーム</a>
      </nav>
    </header>
    
    <main>
      <div class="form-container">
        <form method="POST" action="<%= isEdit ? `/companies/${company.id}` : '/companies' %>">
          
          
          <div class="form-group">
            <label for="company_name">企業名 *</label>
            <input type="text" id="company_name" name="company_name" required
                   placeholder="例: 株式会社サンプル"
                   value="<%= company ? company.company_name : '' %>">
          </div>
          
          <div class="form-group">
            <label for="industry">業種 *</label>
            <select id="industry" name="industry" required>
              <option value="">業種を選択してください</option>
              <option value="飲食店" <%= company && company.industry === '飲食店' ? 'selected' : '' %>>飲食店</option>
              <option value="美容・サロン" <%= company && company.industry === '美容・サロン' ? 'selected' : '' %>>美容・サロン</option>
              <option value="ファッション・アパレル" <%= company && company.industry === 'ファッション・アパレル' ? 'selected' : '' %>>ファッション・アパレル</option>
              <option value="小売・EC" <%= company && company.industry === '小売・EC' ? 'selected' : '' %>>小売・EC</option>
              <option value="不動産" <%= company && company.industry === '不動産' ? 'selected' : '' %>>不動産</option>
              <option value="健康・フィットネス" <%= company && company.industry === '健康・フィットネス' ? 'selected' : '' %>>健康・フィットネス</option>
              <option value="教育・スクール" <%= company && company.industry === '教育・スクール' ? 'selected' : '' %>>教育・スクール</option>
              <option value="旅行・観光" <%= company && company.industry === '旅行・観光' ? 'selected' : '' %>>旅行・観光</option>
              <option value="製造業" <%= company && company.industry === '製造業' ? 'selected' : '' %>>製造業</option>
              <option value="IT・テクノロジー" <%= company && company.industry === 'IT・テクノロジー' ? 'selected' : '' %>>IT・テクノロジー</option>
              <option value="医療・クリニック" <%= company && company.industry === '医療・クリニック' ? 'selected' : '' %>>医療・クリニック</option>
              <option value="その他サービス" <%= company && company.industry === 'その他サービス' ? 'selected' : '' %>>その他サービス</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="start_date">SNS運用開始日 *</label>
            <input type="date" id="start_date" name="start_date" required
                   value="<%= company ? company.start_date : '' %>">
            <small>運用代行を開始した日付を入力してください</small>
          </div>
          
          <div class="form-group">
            <label for="initial_followers">開始時のフォロワー数</label>
            <input type="number" id="initial_followers" name="initial_followers" 
                   min="0" placeholder="0"
                   value="<%= company ? company.initial_followers : '' %>">
            <small>運用開始時点でのフォロワー数（成長を測定するベースライン）</small>
          </div>

          <div class="form-group">
            <label for="plan">契約プラン *</label>
            <select id="plan" name="plan" required>
              <option value="">プランを選択してください</option>
              <option value="ベーシックプラン" <%= company && company.plan === 'ベーシックプラン' ? 'selected' : '' %>>ベーシックプラン</option>
              <option value="スタンダードプラン" <%= company && company.plan === 'スタンダードプラン' ? 'selected' : '' %>>スタンダードプラン</option>
              <option value="プレミアムプラン" <%= company && company.plan === 'プレミアムプラン' ? 'selected' : '' %>>プレミアムプラン</option>
            </select>
            <small>クライアント企業が契約している運用代行プランを選択してください</small>
          </div>
          
          <div class="form-actions">
            <a href="/companies" class="btn btn-secondary">キャンセル</a>
            <button type="submit" class="btn btn-primary">
              <%= isEdit ? '更新する' : '登録する' %>
            </button>
          </div>
        </form>
      </div>
    </main>
  </div>

  <script>
    // フォーム送信前のバリデーション
    document.querySelector('form').addEventListener('submit', function(e) {
      const companyName = document.getElementById('company_name').value.trim();
      const industry = document.getElementById('industry').value;
      const startDate = document.getElementById('start_date').value;
      const plan = document.getElementById('plan').value;
      
      if (!companyName || !industry || !startDate || !plan) {
        e.preventDefault();
        alert('必須項目をすべて入力してください。');
        return;
      }
      
      // 開始日が未来でないかチェック
      const selectedDate = new Date(startDate);
      const today = new Date();
      today.setHours(23, 59, 59, 999);
      
      if (selectedDate > today) {
        e.preventDefault();
        alert('運用開始日は今日以前の日付を選択してください。');
        return;
      }
    });
    
  </script>
</body>
</html>